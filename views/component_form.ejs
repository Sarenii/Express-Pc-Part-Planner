<% layout('layout') -%>
<h1><%= title %></h1>

<form action="" method="POST">
  <fieldset>
    <legend>NAME</legend>
    <input
      required
      type="text"
      name="name"
      id="name"
      value="<%= typeof component == 'undefined' ? '' : component.name %>"
    />
  </fieldset>
  <fieldset for="description">
    <legend>FEATURES</legend>
    <textarea required name="description" id="description">
<%= typeof component == 'undefined' ? '' : component.description %></textarea
    >
    <sub>Separate features with a comma</sub>
  </fieldset>
  <fieldset for="price">
    <legend>PRICE [USD]</legend>
    <div id="price-input">
      <span id="dollar-sign">$</span>
      <input
      type="number"
      step="0.01"
      name="price"
      id="price"
      value="<%= typeof component != 'undefined' ? parseFloat(component.price) : 0%>"
      required
    />
    </div>
    
  </fieldset>
  <fieldset for="inStock">
    <legend>STOCK</legend>
    <input
      type="number"
      name="inStock"
      id="inStock"
      value="<%= typeof component != 'undefined' ? parseInt(component.inStock) : 0%>"
      required
    />
  </fieldset>
  <fieldset for="category">
    <legend>SELECT CATEGORY</legend>
    <select name="category" id="category" required>
        <% categories.forEach(category => { %>
            <% if (typeof component != 'undefined') { %>
                <% var selected = category._id.toString() === component.category._id.toString() ? 'selected' : '' %>
                <option value="<%= category._id %>" <%= selected %> ><%= category.title %> </option>
            <% } else { %>
                <option value="<%= category._id %> "><%= category.title %> </option>
                <% } %>
        <% }) %>
    </select>
  </fieldset>
  <fieldset for="manufacturer">
    <legend>SELECT MANUFACTURER</legend>
    <select name="manufacturer" id="manufacturer" required>
        <% manufacturers.forEach(manufacturer => { %>
            <% if (typeof component != 'undefined') { %>
                <% var selected = manufacturer._id.toString() === component.manufacturer._id.toString() ? 'selected' : '' %> 
                <option value="<%= manufacturer._id %>" <%= selected %>> <%= manufacturer.name %> </option>
            <% } else { %>
                <option value="<%= manufacturer._id %> "><%= manufacturer.name %> </option>
                <% } %>
        <% }) %>
    </select>
  </fieldset>

  <button type="submit">Submit</button>
</form>

<% if (typeof errors != 'undefined') { %>
<ul>
  <% errors.forEach(err => { %>
  <li><%= err.msg %></li>
  <% }) %>
</ul>
<% } %>

<a href="<%= typeof component == 'undefined' ? '/components' : component.url %>">Cancel</a>