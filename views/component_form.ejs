<% layout('layout') -%>
<h1><%= title %></h1>

<form action="" method="POST">
  <label for="name">
    <p>Name:</p>
    <input
      required
      type="text"
      name="name"
      id="name"
      value="<%= typeof component == 'undefined' ? '' : component.name %>"
    />
  </label>
  <label for="description">
    <p>Features:</p>
    <p>Separate features with a comma</p>
    <textarea required name="description" id="description">
<%= typeof component == 'undefined' ? '' : component.description %></textarea
    >
  </label>
  <label for="price">
    <p>Price:</p>
    <input
      type="number"
      step="0.01"
      name="price"
      id="price"
      value="<%= typeof component != 'undefined' ? parseFloat(component.price) : 0%>"
      required
    />
  </label>
  <label for="inStock">
    <p>Stock:</p>
    <input
      type="number"
      name="inStock"
      id="inStock"
      value="<%= typeof component != 'undefined' ? parseInt(component.inStock) : 0%>"
      required
    />
  </label>
  <label for="category">
    <p>Select category:</p>
    <select name="category" id="category" required>
        <% categories.forEach(category => { %>
            <% if (typeof component != 'undefined') { %>
                <% var selected = category._id.toString() === component.category._id.toString() ? 'selected' : '' %>
                <option value="<%= category._id %>" <%= selected %> ><%= category.title %> </option>
            <% } else { %>
                <option value="<%= category._id %> "><%= category.title %> </option>
                <% } %>
        <% }) %>
    </select>
  </label>
  <label for="manufacturer">
    <p>Select manufacturer:</p>
    <select name="manufacturer" id="manufacturer" required>
        <% manufacturers.forEach(manufacturer => { %>
            <% if (typeof component != 'undefined') { %>
                <% var selected = manufacturer._id.toString() === component.manufacturer._id.toString() ? 'selected' : '' %> 
                <option value="<%= manufacturer._id %>" <%= selected %>> <%= manufacturer.name %> </option>
            <% } else { %>
                <option value="<%= manufacturer._id %> "><%= manufacturer.name %> </option>
                <% } %>
        <% }) %>
    </select>
  </label>

  <button type="submit">Submit</button>
</form>

<% if (typeof errors != 'undefined') { %>
<ul>
  <% errors.forEach(err => { %>
  <li><%= err.msg %></li>
  <% }) %>
</ul>
<% } %>

<a href="<%= typeof component == 'undefined' ? '/components' : component.url %>">Cancel</a>